#include "osc_ui.h"

/*
划线函数，将Y轴坐标进行翻转变换
*/
void lcd_drawline(u16 x1, u16 y1, u16 x2, u16 y2)
{
	LCD_DrawLine(x1,240-y1,x2,240-y2);
}

/*
显示示波器界面所需的参数名称
*/
void show_const_arg()
{
	LCD_ShowString(0,0,100,16,16,     "f_set:");		
	LCD_ShowString(60,0,100,16,16,    "MAX:");		
	LCD_ShowString(100,0,100,16,16,   "MIN:");
	LCD_ShowString(140,0,100,16,16,   "OSR:(Hz)");
	LCD_ShowString(220,0,100,16,16,   "md:");
	
	LCD_ShowString(250,0,80,16,16,    "DIVX(us):");
	LCD_ShowString(250,40,80,16,16,   "DIVY(mv):");
	LCD_ShowString(250,80,80,16,16,   "VPP:");
	LCD_ShowString(250,120,80,16,16,  "AVE:");
	LCD_ShowString(250,160,80,16,16,  "f(Hz):");
	LCD_ShowString(241,200,80,16,16,  "OFFSET(mv):");			
}

/*
画示波器的框框，和分度线，以及显示各个参数的数值
*/
void show_ui()
{
	int16_t i;
	
	POINT_COLOR = WHITE;
	//画框框
	lcd_drawline(0,0,  0,200);
	lcd_drawline(0,0,  240,0);
	lcd_drawline(0,200,240,200);
	lcd_drawline(240,0,240,200);
	lcd_drawline(120,0,120,200);
	lcd_drawline(0,100,240,100);
	
	//画分度线
	for(i=0;i<12;i++)
	{
		lcd_drawline(20+i*20,100,20+i*20,105);
	}
	for(i=0;i<10;i++)
	{
		lcd_drawline(120,i*20,125,i*20);
	}
	
	POINT_COLOR = BLUE;
	//显示各个参数数值
	LCD_ShowNum(0,20,   10,  5,16);
	LCD_ShowxNum(60,20, 20,    4,16,0X80);
	LCD_ShowNum(100,20, 30,    4,16);
	LCD_ShowNum(140,20, 40,    6,16);
	LCD_ShowNum(220,20, 50,    2,16);
	LCD_ShowNum(250,20, 60,    4,16);
	LCD_ShowNum(250,60, 70,    4,16);
	LCD_ShowNum(250,100,80,    4,16);
	LCD_ShowNum(250,140,90,    4,16);
	LCD_ShowNum(250,180,100,   5,16);
	LCD_ShowNum(250,220,110,   4,16);
	 
	POINT_COLOR = YELLOW;
	
}

//正弦波数据
int16_t DAC_Value[240] ={
	2048,2176,2304,2431,2557,2680,2801,2919,3034,3144,
	3251,3352,3449,3540,3625,3704,3776,3842,3900,3951,
	3995,4031,4059,4079,4091,4095,4092,4080,4060,4032,
	3996,3952,3901,3843,3778,3706,3627,3542,3451,3355,
	3253,3147,3037,2922,2804,2683,2560,2434,2307,2179,
	2051,1922,1794,1667,1542,1418,1297,1179,1064,953,
	847,745,648,557,472,393,321,255,196,145,
	101,65,37,16,4,0,3,15,35,63,98,
	141,192,250,315,387,466,551,641,738,839,
	945,1056,1170,1288,1409,1532,1658,1784,1912	,
	2048,2176,2304,2431,2557,2680,2801,2919,3034,3144,
	3251,3352,3449,3540,3625,3704,3776,3842,3900,3951,
	3995,4031,4059,4079,4091,4095,4092,4080,4060,4032,
	3996,3952,3901,3843,3778,3706,3627,3542,3451,3355,
	3253,3147,3037,2922,2804,2683,2560,2434,2307,2179,
	2051,1922,1794,1667,1542,1418,1297,1179,1064,953,
	847,745,648,557,472,393,321,255,196,145,
	101,65,37,16,4,0,3,15,35,63,98,
	141,192,250,315,387,466,551,641,738,839,
	945,1056,1170,1288,1409,1532,1658,1784,1912	,
	2048,2176,2304,2431,2557,2680,2801,2919,3034,3144,
	3251,3352,3449,3540,3625,3704,3776,3842,3900,3951,
	3995,4031,4059,4079,4091,4095,4092,4080,4060,4032,
	3996,3952,3901,3843,3778,3706,3627,3542,3451,3355,
};


/*
显示波形
*/
void show_wave()
{
	int16_t i;
	for(i=0;i<239;i++)
	{
		lcd_drawline(i,DAC_Value[i]*200/4096,i+1,DAC_Value[i+1]*200/4096);	
	}
}

void osc_ui_init()
{
	LCD_Init();
	POINT_COLOR = RED;
	LCD_Display_Dir(1);  //将显示屏横屏
	LCD_Clear(BLACK);
	show_const_arg();
	show_ui();
	show_wave();
}

void osc_ui_loop()
{
	
}